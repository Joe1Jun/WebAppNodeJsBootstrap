<!-- design inspired by https://www.nueko.de/-->
<!--the main container is styles in css   -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/style.css" />
    <script src="/app.js"></script>
    <title>Cart</title>
  </head>
  <body>
    <%- include('navbar') %>

    <div style="height: 200px"></div>
    <div class="text-center" style="height: 100px">
      <h1>Cart</h1>
    </div>

    <!-- Main container -->
    <div class="container" id="checkout-main-container">
      <!-- Iterate over each product in the cart -->
      <% cart.forEach(product => { %>
      <!-- Product container -->
      <div class="row">
        <!-- Left Section - Image -->
        <div class="col-6">
          <div class="container text-center">
            <img
              src="/images/shop2Images/<%= product.image1 %>"
              alt=""
              class="img-fluid mb-3 product-image rounded-3"
            />
          </div>
        </div>
        <!-- Right Section - Product Description -->
        <!-- col-6 takes 6 columns of bootstraps grid system-->
        <!--text-center places text in center-->
        <div class="col-6 mt-4">
          <div class="text-container">
            <div class="text-center">
              <!-- mb-4 gives margin bottom to add spacing-->
              <!-- product information is displayed dyanmicallu after being passed from /cart route-->
              <h5 class="mb-4"><%= product.name %></h5>
              <p class="mb-4" style="font-size: 1.2rem">
                <%= product.description %>
              </p>
              <p class="mb-4">€<%= product.price %></p>
              <!-- this form is for increasing or decreasing product quantity-->

              <form action="/edit_product_quantity" method="post">
                <!-- Hidden input for product Id -->
                <input type="hidden" value="<%= product.Id %>" name="Id" />

                <!-- Button to decrease quantity -->
                <!-- Button name to identify which action to perform -->
                <!-- names are  used in router.post('/edit_product_quantity') route -->
                <input
                  type="submit"
                  value="-"
                  name="decrease_product_quantity"
                />

                <!-- Input to display quantity (readonly) -->
                <!-- Makes the input readonly -->
                <input
                  type="text"
                  name="quantity"
                  value="<%= product.quantity %>"
                  readonly
                />

                <!-- Button to increase quantity -->
                <!-- Button name to identify which action to perform this will be used in the route -->

                <input
                  type="submit"
                  value="+"
                  name="increase_product_quantity"
                />
              </form>
              <!-- This form access the /remove_product route that will delete the product object from the cart.session array when the remove button is executed-->
              <!-- It uses the id of the object that is retreived by the -->
              <form action="/remove_product" method="post">
                <input type="hidden" name="Id" value="<%= product.Id %>" />

                <button class="btn btn-primary mt-4">Remove</button>
              </form>
            </div>
          </div>
        </div>
      </div>
      <% }); %>
    </div>

    <div class="container text-center" id="checkout-main-container">
      <!--total is displayed dynamically and is calculated by the calculateTotal function in functions.js module-->
      <h5 class="mb-4">Total:€<%= total %></h5>
      <div class="container text-center">
        <!-- Form for checkout button -->
        <!--checkout button links to /checkout page unless user is not authenticated true auth.js and express-session in which case they will be directed to log in -->

        <form action="/checkout" method="get">
          <button type="submit" class="mb-4 btn btn-primary">Checkout</button>
        </form>
      </div>
    </div>

    <%- include('footer') %>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
